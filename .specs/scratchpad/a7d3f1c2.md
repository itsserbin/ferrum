# Research Scratchpad: Winit 0.30 API Verification

Task: Verify winit 0.30 API for multi-window support and keyboard/mouse events
Created: 2026-02-15

---

## Problem Definition

### Research Questions
- Primary: What is the current latest version of winit on crates.io as of February 2026?
- Secondary: What are the exact API signatures for multi-window support, keyboard events, mouse events, and ApplicationHandler methods?

### Context & Constraints
- Project: Ferrum GUI application (Rust)
- Current reference: winit 0.30
- Need: EXACT type signatures for implementation
- Timeline: Immediate (for current development)

### Success Criteria
- [ ] Confirmed latest winit version on crates.io
- [ ] Multi-window API documented with exact methods
- [ ] Keyboard event types and fields documented with exact Rust types
- [ ] Mouse event types documented with exact fields
- [ ] ApplicationHandler trait methods documented
- [ ] Breaking changes from 0.29 to latest identified

---

## Research Log

### Entry 1: Check Latest Winit Version
THOUGHT: I need to check crates.io for the latest published version of winit as of February 2026...
ACTION: Search[crates.io winit latest version]
OBSERVATION:
- Source: https://docs.rs/winit/latest/winit/
- Date: 2026-02-15 (checked)
- Key Facts: Latest version is 0.30.12
- Confidence: High (docs.rs shows exact version)

### Entry 2: WindowEvent Enum Variants
THOUGHT: I need the exact field types for WindowEvent variants, especially keyboard and mouse events...
ACTION: Analyze[docs.rs/winit/latest/winit/event/enum.WindowEvent.html]
OBSERVATION:
- Source: https://docs.rs/winit/latest/winit/event/enum.WindowEvent.html
- Date: Version 0.30.12
- Key Facts:
  - KeyboardInput: `device_id: DeviceId, event: KeyEvent, is_synthetic: bool`
  - CursorMoved: `device_id: DeviceId, position: PhysicalPosition<f64>`
  - MouseInput: `device_id: DeviceId, state: ElementState, button: MouseButton`
  - CursorLeft: `device_id: DeviceId`
  - ModifiersChanged: `Modifiers`
- Confidence: High (official docs)

### Entry 3: KeyEvent Struct Fields
THOUGHT: I need exact field types for KeyEvent...
ACTION: Analyze[docs.rs/winit/latest/winit/event/struct.KeyEvent.html]
OBSERVATION:
- Source: https://docs.rs/winit/latest/winit/event/struct.KeyEvent.html
- Key Facts:
  - physical_key: PhysicalKey
  - logical_key: Key
  - text: Option<SmolStr>
  - location: KeyLocation
  - state: ElementState
  - repeat: bool
- Confidence: High

### Entry 4: Key Enum and Character Type
THOUGHT: I need to know the exact type of Key::Character variant...
ACTION: Analyze[docs.rs/winit/latest/winit/keyboard/enum.Key.html]
OBSERVATION:
- Source: https://docs.rs/winit/latest/winit/keyboard/enum.Key.html
- Key Facts:
  - Enum definition: `pub enum Key<Str = SmolStr>`
  - Character variant: `Character(Str)` - defaults to SmolStr
  - Named variant: `Named(NamedKey)`
  - Dead variant: `Dead(Option<char>)`
  - Unidentified variant: `Unidentified(NativeKey)`
- Confidence: High
- Note: Can use as_ref() to convert Key::Character(SmolStr) to Key::Character(&str)

### Entry 5: NamedKey Variants
THOUGHT: I need the exact NamedKey variants for common keys...
ACTION: Analyze[docs.rs/winit/latest/winit/keyboard/enum.NamedKey.html]
OBSERVATION:
- Key Facts:
  - Enter, Backspace, Tab, Escape, Delete, Insert
  - ArrowUp, ArrowDown, ArrowLeft, ArrowRight
  - Enum is #[non_exhaustive] with 306+ variants
- Confidence: High

### Entry 6: Modifiers and ModifiersState
THOUGHT: I need to understand how to check modifier key states...
ACTION: Analyze[Modifiers struct and ModifiersState]
OBSERVATION:
- Source: https://docs.rs/winit/latest/winit/event/struct.Modifiers.html
- Modifiers struct: has private fields, provides:
  - state() -> ModifiersState
  - lshift_state(), rshift_state(), lalt_state(), ralt_state()
  - lcontrol_state(), rcontrol_state(), lsuper_state(), rsuper_state()
- ModifiersState methods:
  - shift_key() -> bool
  - control_key() -> bool
  - alt_key() -> bool
  - super_key() -> bool
- Confidence: High

### Entry 7: ApplicationHandler Trait
THOUGHT: I need exact method signatures for ApplicationHandler...
ACTION: Analyze[docs.rs/winit/latest/winit/application/trait.ApplicationHandler.html]
OBSERVATION:
- Required methods:
  - fn resumed(&mut self, event_loop: &ActiveEventLoop)
  - fn window_event(&mut self, event_loop: &ActiveEventLoop, window_id: WindowId, event: WindowEvent)
- Provided methods:
  - fn new_events(&mut self, event_loop: &ActiveEventLoop, cause: StartCause)
  - fn user_event(&mut self, event_loop: &ActiveEventLoop, event: T)
  - fn device_event(&mut self, event_loop: &ActiveEventLoop, device_id: DeviceId, event: DeviceEvent)
  - fn about_to_wait(&mut self, event_loop: &ActiveEventLoop)
  - fn suspended(&mut self, event_loop: &ActiveEventLoop)
  - fn exiting(&mut self, event_loop: &ActiveEventLoop)
  - fn memory_warning(&mut self, event_loop: &ActiveEventLoop)
- Confidence: High

### Entry 8: Multi-Window Support
THOUGHT: I need to verify multi-window creation and event routing...
ACTION: Analyze[ActiveEventLoop and WindowId]
OBSERVATION:
- Source: https://docs.rs/winit/latest/winit/event_loop/struct.ActiveEventLoop.html
- ActiveEventLoop::create_window(WindowAttributes) -> Result<Window, OsError>
- YES, can create multiple windows
- WindowId obtained via window.id()
- window_event() receives WindowId parameter for routing
- Example: child_window.rs demonstrates HashMap<WindowId, Window> pattern
- Confidence: High

### Entry 9: Breaking Changes 0.29 to 0.30
THOUGHT: I need to identify breaking changes for migration...
ACTION: Analyze[changelog]
OBSERVATION:
- Source: https://docs.rs/winit/latest/winit/changelog/index.html
- Major changes:
  - EventLoop::run deprecated -> use EventLoop::run_app with ApplicationHandler trait
  - Window::new removed -> use ActiveEventLoop::create_window
  - WindowBuilder removed -> use WindowAttributes
  - EventLoopWindowTarget renamed to ActiveEventLoop
  - Closure-based API replaced with trait-based ApplicationHandler
  - MSRV bumped 1.65 -> 1.70
- Confidence: High

---

## Technical Analysis

### Version Status
- Latest: winit 0.30.12 (as of 2026-02-15)
- 0.30.x is current stable series
- No 0.31 found yet

### Multi-Window Support Assessment
- **Features**: Full multi-window support via ActiveEventLoop::create_window
- **Integration**: Use HashMap<WindowId, Window> pattern for tracking
- **Event Routing**: WindowId parameter in window_event() enables routing
- **Learning Curve**: Medium (trait-based API is straightforward)
- **Performance**: Efficient (WindowId is Copy)
- **Verdict**: Recommend - well-designed API

### Keyboard API Assessment
- **Type Safety**: Strong - Key enum with generic parameter
- **Character Handling**: SmolStr default (can convert to &str via as_ref())
- **Named Keys**: Comprehensive NamedKey enum (306+ variants)
- **Modifiers**: Clean API via ModifiersState methods
- **Verdict**: Recommend - excellent API design

### Mouse API Assessment
- **Events**: CursorMoved, MouseInput, CursorLeft all present
- **Position**: PhysicalPosition<f64> for cursor
- **Button State**: ElementState and MouseButton types
- **Verdict**: Recommend - complete API

---

## Draft Output

### Executive Summary
Winit 0.30.12 is the latest version (as of Feb 2026) with stable multi-window support, comprehensive keyboard/mouse event APIs, and a trait-based ApplicationHandler design. The 0.29 to 0.30 migration involves replacing closure-based event loops with trait implementations.

### Key API Signatures

**KeyEvent**:
```rust
pub struct KeyEvent {
    pub physical_key: PhysicalKey,
    pub logical_key: Key,
    pub text: Option<SmolStr>,
    pub location: KeyLocation,
    pub state: ElementState,
    pub repeat: bool,
}
```

**Key Enum**:
```rust
pub enum Key<Str = SmolStr> {
    Character(Str),        // Default: SmolStr
    Named(NamedKey),       // Enter, Backspace, Tab, Arrow keys, etc.
    Dead(Option<char>),
    Unidentified(NativeKey),
}
```

**WindowEvent Variants** (relevant):
- KeyboardInput: `device_id: DeviceId, event: KeyEvent, is_synthetic: bool`
- CursorMoved: `device_id: DeviceId, position: PhysicalPosition<f64>`
- MouseInput: `device_id: DeviceId, state: ElementState, button: MouseButton`
- CursorLeft: `device_id: DeviceId`
- ModifiersChanged: `Modifiers`

**ApplicationHandler Trait**:
```rust
pub trait ApplicationHandler<T: 'static = ()> {
    fn resumed(&mut self, event_loop: &ActiveEventLoop);
    fn window_event(&mut self, event_loop: &ActiveEventLoop, window_id: WindowId, event: WindowEvent);

    // Provided methods:
    fn about_to_wait(&mut self, event_loop: &ActiveEventLoop) {}
    fn new_events(&mut self, event_loop: &ActiveEventLoop, cause: StartCause) {}
    // ... others
}
```

**Multi-Window**:
```rust
impl ActiveEventLoop {
    pub fn create_window(&self, window_attributes: WindowAttributes) -> Result<Window, OsError>
}
```

### Modifier Checking
```rust
// From ModifiersState
modifiers.state().control_key()  // -> bool
modifiers.state().alt_key()      // -> bool
modifiers.state().shift_key()    // -> bool
```

### Breaking Changes (0.29 -> 0.30)
1. Window::new removed - use ActiveEventLoop::create_window
2. WindowBuilder removed - use WindowAttributes
3. EventLoop::run deprecated - use EventLoop::run_app
4. Closure-based API replaced with ApplicationHandler trait
5. EventLoopWindowTarget renamed to ActiveEventLoop

---

## Self-Critique

### Verification Results

| # | Verification Question | Evidence | Confidence |
|---|----------------------|----------|------------|
| 1 | Source Verification: Cited official docs? | All sources from docs.rs/winit/latest | High |
| 2 | Recency Check: Latest version confirmed? | 0.30.12 confirmed from docs.rs on 2026-02-15 | High |
| 3 | Alternatives Completeness: Explored alternatives? | N/A - this is API verification, not comparison | N/A |
| 4 | Actionability: Can reader use this immediately? | Exact type signatures provided for all queries | High |
| 5 | Evidence Quality: Facts vs inferences? | All facts from official documentation | High |

### Gaps Found
None - all requested information verified with exact type signatures.

### Revisions Made
None needed - initial research covered all requirements.
